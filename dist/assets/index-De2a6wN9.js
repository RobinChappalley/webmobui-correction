var M=Object.defineProperty;var O=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var q=(e,t,r)=>O(e,typeof t!="symbol"?t+"":t,r);var m=(e,t,r)=>new Promise((o,n)=>{var i=a=>{try{f(r.next(a))}catch(v){n(v)}},d=a=>{try{f(r.throw(a))}catch(v){n(v)}},f=a=>a.done?o(a.value):Promise.resolve(a.value).then(i,d);f((r=r.apply(e,t)).next())});var oe=P(y=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();class H extends HTMLElement{connectedCallback(){this.innerHTML=`
      <a href="${this.getAttribute("href")}">
        <img src="${this.getAttribute("image_url")}" />
        <div class="artist-list-item-title">${this.getAttribute("name")}</div>
      </a>
    `}}customElements.define("artist-cover",H);const N=new CustomEvent("play_click"),R=new CustomEvent("favorite_click");class k extends HTMLElement{connectedCallback(){this.render()}attributeChangedCallback(){this.render()}render(){const t=this.getAttribute("favorite")=="true"?"favorite":"favorite_border";this.innerHTML=`<a href="#">
      <div class="list-item-title">${this.getAttribute("title")}</div>
      <div class="list-item-actions">
        <button type="button" class="icon-button favorite-button ">
          <span class="material-icons">${t}</span>
        </button>
        <button type="button" class="icon-button play-button">
          <span class="material-icons">play_arrow</span>
        </button>
      </div>
    </a>`,this.querySelector(".play-button").addEventListener("click",r=>{r.preventDefault(),this.dispatchEvent(N)}),this.querySelector(".favorite-button").addEventListener("click",r=>{r.preventDefault(),this.dispatchEvent(R)})}}q(k,"observedAttributes",["favorite"]);customElements.define("song-item",k);const l=e=>{var t,r;(t=document.querySelector("section.active"))==null||t.classList.remove("active"),(r=document.querySelector(`${e}-section`))==null||r.classList.add("active")},j=e=>{var t,r;(t=document.querySelector("nav a.active"))==null||t.classList.remove("active"),(r=document.querySelector(`nav a[href="${e}"]`))==null||r.classList.add("active")},D=document.querySelector("#search-trigger"),u=document.querySelector("#search-input");D.addEventListener("click",()=>{u.classList.toggle("active"),u.classList.contains("active")&&u.focus()});u.addEventListener("change",()=>{window.location.hash=`#search-${encodeURIComponent(u.value)}`});const h="https://webmob-ui-22-spotlified.herokuapp.com",g=e=>fetch(e).then(t=>t.json()),F=()=>g(`${h}/api/artists`),J=e=>g(`${h}/api/artists/${e}/songs`),U=e=>g(`${h}/api/songs/search/${e}`),w=document.querySelector("artist-list"),B=()=>m(y,null,function*(){w.innerHTML="",(yield F()).forEach(t=>{const r=document.createElement("artist-cover");r.setAttribute("image_url",t.image_url),r.setAttribute("name",t.name),r.setAttribute("href",`#artists-${t.id}`),w.append(r)})});function I(e){e=parseInt(e,10);let t=Math.floor(e/3600),r=Math.floor((e-t*3600)/60),o=e-t*3600-r*60;return r<10&&(r="0"+r),o<10&&(o="0"+o),r+":"+o}const s=document.querySelector("#audio-player"),K=document.querySelector("#player-thumbnail-image"),W=document.querySelector("#player-infos-song-title"),z=document.querySelector("#player-infos-artist-name"),G=document.querySelector("#player-control-previous"),Q=document.querySelector("#player-control-next"),$=document.querySelector("#player-control-play"),x=$.querySelector(".material-icons"),V=document.querySelector("#player-time-current"),X=document.querySelector("#player-time-duration"),L=document.querySelector("#player-progress-bar"),C=document.querySelector("#logo");let c=[],b=null;const S=(e,t)=>{b=e,t&&(c=t),s.src=e.audio_url,s.play(),W.innerText=e.title,z.innerText=e.artist.name,K.src=e.artist.image_url},Y=()=>{let e=c.indexOf(b)+1;e==c.length&&(e=0),S(c[e])},Z=()=>{let e=c.indexOf(b)-1;e==-1&&(e=c.length-1),S(c[e])};$.addEventListener("click",()=>{s.paused?s.play():s.pause()});G.addEventListener("click",Z);Q.addEventListener("click",Y);L.addEventListener("change",e=>{s.currentTime=e.currentTarget.value});s.addEventListener("durationchange",()=>{L.max=s.duration,X.innerText=I(s.duration)});s.addEventListener("timeupdate",()=>{L.value=s.currentTime,V.innerText=I(s.currentTime)});s.addEventListener("play",()=>{x.innerText="pause",C.classList.add("animated")});s.addEventListener("pause",()=>{x.innerText="play_arrow",C.classList.remove("animated")});const ee=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),p=e=>JSON.parse(localStorage.getItem(e)),te=()=>Object.keys(localStorage).map(p),re=e=>localStorage.removeItem(e),A=document.querySelector(".list"),E=document.querySelector("#list-section h4"),T=e=>{A.innerHTML="",e.forEach(t=>{const r=document.createElement("song-item");r.setAttribute("title",t.title),r.setAttribute("favorite",!!p(t.id)),r.addEventListener("play_click",()=>{S(t,e)}),r.addEventListener("favorite_click",()=>{p(t.id)?re(t.id):ee(t.id,t),r.setAttribute("favorite",!!p(t.id))}),A.appendChild(r)})},ne=e=>m(y,null,function*(){const t=yield J(e);E.innerHTML=`Artistes > ${t[0].artist.name}`,T(t)}),se=e=>m(y,null,function*(){const t=yield U(e);E.innerHTML=`RÃ©sultats de recherche pour : ${decodeURIComponent(e)}`,T(t)}),ie=()=>{const e=te();E.innerHTML="Favoris",T(e)},_=()=>{const t=(window.location.hash||"#home").split("-");switch(j(t[0]),t[0]){case"#home":l("#home");break;case"#player":l("#player");break;case"#artists":t[1]?(l("#list"),ne(t[1])):(l("#artists"),B());break;case"#search":l("#list"),se(t[1]);break;case"#favorites":l("#list"),ie();break}};window.addEventListener("hashchange",_);_();window.addEventListener("offline",e=>document.body.classList.add("offline"));window.addEventListener("online",e=>document.body.classList.remove("offline"));navigator.serviceWorker.register("service-worker.js")});export default oe();
